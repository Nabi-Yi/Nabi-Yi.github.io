---
title: "Routing"

categories:
  - Network
tags:
  - Routing
---
### Routing이란?
뭔가 순서가 거꾸로 된 것 같지만, 이번엔 라우팅에 대해서 알아보자.  
Routing은 Route(길)에서 알 수 있듯, 목적지까지 가는 길을 알아내는 방법이다. 네비게이션을 생각하면 쉽게 이해 할 수 있다.  

다만 여기서 목적지는 IP주소로 되어있는 주소일 뿐이다. 서울에서 부산까지 간다고 했을 때 길을 설계하고 안내해주는 네비게이션과 같은 것이 Router라는 장치가 있고, 고속도로에서 분기가 나뉘는 톨게이트는 Gateway라는 장치로 볼 수 있다.(단 항상 최적의 경로를 탐색하지는 않는다..)  
라우팅은 OSI Layer기준 주로 3계층(Network layer)에서 이루어진다.  

![](https://nabi-yi.github.io/assets/images/220607_trainSwitch.jpg){: .align-center}  
###### *출처 : https://blog.daum.net/kyung7/12580891*  
 마치 철로의 스위치처럼, 각 라우터는 어디로 가야할지를 정해준다.  

### 어떻게 찾아가나?
 일단 라우팅에는 크게 두가지 방법이 있다. **동적 라우팅** 과 **정적 라우팅** 이다.  
DNS에 비유를 들 수 있는데, **정적 라우팅**은 DNS를 거치지 않고 IP주소를 바로 입력하는 것과 유사하고(이미 길이 관리자에 의해 설정되어있거나 필요한 정보가 입력되어 있음), **동적 라우팅**은 DNS Resolver가 IP주소를 찾아오듯 라우터가 열심히 길을 탐색하여 설계하는 방법이다. 아무래도 정적 라우팅이 탐색에 걸리는 시간이 없으니 빠르고 안정적이나, 네트워크가 변화하거나 하는 경우에 대응이 힘들다.  

## Routing Table / Distance Vector
 각 라우터는 자신이 연결할 수 있는 인접 라우터에 대한 정보를 가지고 있다. 이를 Routing Table이라 하는데, 다른 라우터를 거치지 않고 직접적으로 연결되는 노드에 대한 방향(Vector)과 거리(Distance)를 저장한다. 그리고 이 Routing Table을 다시 그 인접 라우터들에 전파하는데, 이 정보를 전달 받은 라우터는 자신의 Routing Table에 해당 정보를 취합한다.  

이런 식으로 거미줄 뻗어나가듯 어떤 지점에까지 도달 할 수 있는 Table들을 각 라우터들은 가지고 있고, 이를 토대로 우리에게 해당 IP로 가는 길을 알려 줄 수 있으며, 여러가지 길이 있을 경우 Distance가 가장 짧은 길을 안내 해 최적의 경로를 탐색할 수 있는 것이다.   

단, 길을 알아냈다고 해당 경로를 바로 쭉~ 가는게 아니라, 라우터는 바로 다음 라우터만을 안내하며, 거치는 라우터마다 다시 경로를 탐색하는데, 한 단계씩 포워딩하여 Hop-by-Hop 라우팅이라 한다.  

이 때, 일종의 greedy algorithm (?) 의 함정에 빠져 반드시 최적의 길이 아닐 수 있으며, 루프를 도는 경우도 있고, 때문에 TTL(Time To Live)가 있어 최대 거칠 수 있는 Hop을 제한한다. 어쩌다 TTL error를 본 적이 있는데 그런 의미였다.   
라우팅 테이블에서 길을 못찾을 경우, 해당 패킷을 드랍하므로써 broadcasting control을 할 수 있다.

## Router?
 우리가 가장 흔하게 찾아 볼 수 있는 라우터는 인터넷 공유기다. 공유기는 내부망과 외부망을 가르는 지점이기도 한데.. 내부망은 같은 IP주소를 공유하고 port로 구분하던가.. 뭐 그런게 있었던거 같은데 나중에 다시 찾아봐야겠다.  

## 기타
예전에 학부공부 할때 언듯 기억나는 내용.  
1. 유선이야 PC든 서버든 연결 된 선으로 일단 내 통신을 내보내면 거기에 무언가 있지만, 무선의 경우는 어떨까?  
일단 무선은 자신을 네트워크에 연결시켜줄 기지국을 찾아야한다. 이 때 나 여깄어요!! 내 말 좀 전해주실 분!!하고 기지국을 찾아야 하는데, 처음엔 출력을 작게 소근소근 나 여깄는데 누구 있니? 라고 물어보다가, 응답이 없으면 점점 목소리를 키운다.  
목소리==출력==전력소비 이므로 산골처럼 기지국이 드문 드문 있어 찾기 힘들 수록 배터리가 금방 단다는 얘기가 갑자기 생각이났다.(하여간 학부내용은 이런 것만 기억난다. Acknowledge, Handshaking 같은 건 이름만 기억난다..)   

2. 도심 같은 경우 너무 폰이 많아서 문제인데, 4g,5g로 가면서 주파수가 짧아지다보니 전파의 투과율 문제도 있고, 기지국에서 동시 처리할 수 있는 양에도 부하가 심해질 수 있다.   
때문에 공유기와 같은 접점을 수두룩빽빽이 설치해놓는데(전파 혼선은 주파수를 다르게 해서 피한다.) 이처럼 사용자가 많을 수록 구역을 작게 나누고(접점이 많음), 사람이 적을수록 구역을 크게 나누는데 이러한 네트워크를 Celluar Network라 하고 이 때문에 영어로 핸드폰이 Cell Phone이 됐다.(역시 학부내용은 이런것만 기억난다!!)
![](https://nabi-yi.github.io/assets/images/220607_Cell.jpg){: .align-center}
###### *출처 : https://www.tnuda.org*

## 더 공부할 거리
* RIP, OSPF, BGP Protocol
* IGP, EGP
* Gateway
* Distance Vector vs Link State
* NAT* 
 
